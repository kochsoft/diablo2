<h1>Horadric Exchange -- a v1.10-v1.14d Diablo II Save Game Editor</h1>

<h2>Motivation</h2>

<p>
This started out as a learning project about how to access intricate binary files.
</p><p>
Primary goal was the 'simple task' of taking the contents of the Horadric
Cube from one single player Diablo II character's inventory and swap it with
the contents of the Horadric Cube of a different single player Diablo II
character.
</p><p>
Why? Because for me this is one of the great frustrations in this game
<i>(coming alongside the fact that I never seem to find any high runes)</i>:
</p><p>
Consider this: Your hero found that <b>sacred globe of divine intervention</b>.
Priceless! Sadly, the joy of it is mitigated by the fact, that the Barbarian
really has no idea what end of the thing to clobber over the head of the next
unsuspecting monster. 
</p><p>
Your Sorceress has more knowledge and would make great use of the globe.
However, she is in a different save game.
</p><p>
As it stands, the Barbarian takes the priceless, shiny thing, walks up to
that Gheed character, and ... you get the picture.
</p><p>
So this tool's original, and still best purpose is to implement above's
'simple task'. So the Barbarian can hand the sacred globe to an overjoyed
expert on using sacred globes, and, maybe, even receive something nice in
return.
</p>

<h2>About the Tools</h2>

<p>
However, the task was not simple. It took me more than a week's evenings
and almost all the knowledge that is to be had from this site:
<a href="https://github.com/WalterCouto/D2CE/blob/main/d2s_File_Format.md">D2CE</a>
to finally reach this goal. The results of this chore are two python 3 scripts. 
</p>

<h3>horazons_folly.py</h3>

<p>
The core command line script, that is sufficient to do everything this project
does to Diablo II v.1.10-v1.14d save game files. It comes
</p>

<ul>
<li>with no additional dependencies. Really. Vanilly python 3 should work just fine.</li>
<li>a generous --help page discribing all its functions.</li>
</ul>

<h3>horadric_exchange.py</h3>

<p>
This script provides a user-friendly graphical interface to <b>horazons_folly.py</b>.
However, it also brings in dependencies:
</p>

<ul>
<li><b>horazons_folly.py</b> obviously.</li>
<li>The python package <b>tkinter</b> needs to be installed and accessible
for the python interpreter. Under Windows this is an option while you install
python. Under Linux this varies depending on your distribution.</li>
</ul>

<h2>Some Erratas and other Comments</h2>
<p>
Concerning <a href=https://github.com/WalterCouto/D2CE/blob/main/d2s_File_Format.md>D2CE</a> I found some points that are noteworthy.
Keep in mind that my perspective is on legacy save game file version <b>96</b> only!
</p>
<p>
While it is true, that attributes come with individual IDs, taking up 9 bits
each, I cannot confirm that they or the values they precede are bit-order-inverted.
</p><p>
However, I found that reading the large values for <b>HP, Mana, and Stamina</b>
presents a problem. They are indeed of length 21 bit. However, it would seem
that only the most 13 significant little endian bits carry the information.
The other 8 bit may also have a function, but that eludes me.
</p><p>
The variable length of the section seems to stem from the fact that values that
are 0 are not listed, but missing. It appears that 0 values are even illegal.
When I tried to add explicit 0 values this led me into a corrupt save-game,
complaining that the skill section (which is beyond attributes) were corrupted.
Only when I made sure, that 0 values are not present all was well again.
</p>
The skill section is far simpler than described. It is preceded with the code
<b>if</b>. However, after that there just come 30 byte values describing
the hard-point skill-levels for the individual skills of the character in
question. The order of skills in the skilltrees is over all trees and
horizontally, beginning by the lowest-most tab. Huh?
</p><p>
Example: Consider the Necromancer. In-game press "T" to open the skills
trees. The lowest tab is "Curses", above is "Poison and Bone", and the top-most
tab is "Summoning". Take these three trees and place them side-by-side.
"Curses" left, "Poison and Bone" in the middle, and on the right "Summoning".
And now read the skills left to right, line by line. First skill is "Amplified
Damage", followed by "Teeth", "Bone Armor", "Skeleton Mastery" and "Raise Skeleton".
Next comes the second row with "Dim Vision", "Weaken", "Poison Dagger", and so on.
The other character classes' skills are organized in the same way.
</p>

