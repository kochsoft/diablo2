<h1>Horadric Exchange -- a v1.10-v1.14d Diablo II inter-Character Item Swapper and Save Game Editor</h1>

<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/logo_horadric_exchange.png" alt="Horadric Exchange" class="center_img">
</figure>

<h2>Disclaimer</h2>
<p>
<b>Editing binary save-games is dangerous and may leave you with corrupt files.
Although an effort has been made, that these scripts do backups of all files they
modify, there is no guarantee. If you use this script, make sure to first do your
own backups of any .d2s file you wish to edit.</b>
</p>
<p>
That being said ...
</p>

<h2>Last night, at the Rogues' camp</h2>

<p>
So, your hero found the <b>sacred globe of divine intervention</b>.
</p>
<p>Sadly, the joy of it is mitigated by the fact, that the Barbarian
really has no idea what end of the thing to clobber over the head of the next
unsuspecting monster.
</p><p>
Your Sorceress has more knowledge and would make great use of the globe.
However, she is in a different save-game.
</p><p>
As it stands, the Barbarian takes the priceless, shiny thing, walks up to
that Gheed character, and ... you get the picture.
</p>

<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/gheed.png" alt="Gheed and Barbarian" class="center_img"><br />
  <figcaption><b>Fig.1</b> - Gheed is a wonderful human being. And a true friend.</figcaption>
</figure>

<h2>What these two scripts are not</h2>
<p>
They are, at this point in time, not for modern versions of Diablo II. More specifically,
they probably won't work very good, if at all, beyond game versions <b>1.10-1.14d</b>.
I would not know, because I only have a legit, but antique v1.12 installation running on
wine-10.1 available. However, it should be a matter of rather straight-forward
modifications of target bit sites in <code>horazons_folly.py</code> to generalize it
to other save-game versions.
</p><p>
While there are, in the more clandestine Horazon's section, facilities that will
provide a Horadric cube and create any rune or gem you could wish for, or
even edit the numbers of sockets in appropriate normal or superior items, creation
powers do not extend beyond that.
So after creating that set of 'Jah Ith Ber' runes, you will still have to find a
suitable armor to go with them yourself.
</p>

<h2>What these two scripts are</h2>

The project mainly comprises

<ul>
  <li><b>horazons_folly.py</b>: A technically simplistic, command line script, that may do
    all the save-game editing magic that I discovered writing the functionality of
    "Horadric Exchange". It runs on vanilla Python 3 and comes with a detailed
    <code>--help</code> text.
    Indispensable source of information was the page
    <a href="https://github.com/WalterCouto/D2CE/blob/main/d2s_File_Format.md">D2CE</a>.
    It contains a lot of knowledge for anyone endeavoring to understand Diablo II
    save-game files.
  </li>
  <li><b>horadric_exchange.py</b>: A comprehensive GUI frontend for <code>horazons_folly.py</code>.
    It brings one dependency: <code>tkinter</code>, the basic, python GUI system.
    On windows, it may be selected as optional during installation of the Python 3
    interpreter. Under Linux there often is a dedicated package to be had, or
    <code>python -m pip install tkinter</code> might help.
    The GUI allows to load and read save-game contents, and to do both, the title-giving
    Horadric Exchanges, and some more clandestine edits, like enabling
    nightmare or hell mode (also upgrading low level characters for standing a chance,
    effectively allowing to start a game in a higher difficulty),
    god mode (reversible, but still gain-maintaining!), or attribute or skill resets, if one
    indulges into the "Horazon's Folly Tab". There is more.
  </li>
</ul>

<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/prior_to_horadric_exchange.png" alt="The Horadric Exchange GUI tab" class="center_img"><br />
  <figcaption><b>Fig.2</b> - The main tab allows to load two characters and to exchange
    items between them via their Horadric Cubes.</figcaption>
</figure>
<br /><br />
<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/250202_moved_items.png" alt="Charonson got an item personalized to Alissa" class="center_img"><br />
  <figcaption><b>Fig.3</b> - Charonson got an item that was personalized to Alissa. Although he will
  still need more experience to make good use of it. She will probably want to have it back
  anyways.</figcaption>
</figure>
<br /><br />
<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/non_magic_ring.png" alt="Alissa wears a regular ring" class="center_img"><br />
  <figcaption><b>Fig.4</b> - Alissa wears a non-magic ring. For its aesthetic value. And because she can.</figcaption>
</figure>
<br /><br />
<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/sword2jewel.png" alt="Charonson turns a magic sword into a socketable jewel" class="center_img"><br />
  <figcaption><b>Fig.5</b> - Charonson turned a magic sword into a socketable jewel. It will add to the perfection of another weapon.</figcaption>
</figure>
<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/charm_breath.png" alt="Charonson turns a runeword item into a small charm" class="center_img"><br />
  <figcaption><b>Fig.6</b> - Charonson turned a runeword weapon (Breath of the Dying) into a small charm. While the direct rune powers are lost, the runeword magic is captured.
  And this is quite powerful in this case. What is more: Level requirements are removed. Since there is no Zod rune any longer, characters of level less than 69 can use the charm.</figcaption>
</figure>

<h2>Setup</h2>

<p>
Installation is as simple as putting both <b>.py</b> files, <b>item_codes.tsv</b>, <b>armor_weapons.tsv</b>, and the two graphics,
<b>logo_horadric_exchange.png</b> and <b>potion_of_life.png</b>, into one directory
and running the desired script using a python 3 interpreter with the script
directory as working directory.
</p>
<p>
<b>There is no config file.</b> Instead, there is a small block "config.sys" close to the
top of <code>horadric_exchange.py</code>. That section provides two global variables
that will define
</p>
<ul>
  <li><b>pname_work:</b> Horadric Exchange does a generous amount of backups of your
  original save-games (with timestamps), .humanity restore files (they will allow
  returning from godmode in a sensible, progress-preserving way), and cube-content
  saves, if this function is used.
  I label these backups necessary, as they will save your characters, if the scripts
  should ever leave you with corrupted files -- editing binary save-games is a
  dangerous process!
  So create some writable directory of your choosing and refer to it here.</li>
  <li><b>pname_d2:</b> The target "Save" directory within the actual game installation.</li>
</ul>

<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/config_sys.png" alt="Use config.sys section in horadric_exchange.py to define default directories." class="center_img"><br />
  <figcaption><b>Fig.7</b> - This global structure in <b>horadric_exchange.py</b> defines default
    values for the necessary backup/working directory and the location of your
    Diablo II v1.10-v1.14d save-game directory.</figcaption>
</figure>

<h2>Usage</h2>
<p>
Both, the <code>--help</code> section of <code>horazons_folly.py</code>, and the
GUI, provided by <code>horadric_exchange.py</code> are rather self-explanatory.
The <code>--help</code> section can also be reviewed in
<a href="https://github.com/kochsoft/diablo2">the README.md file</a>.
</p><p>
Still some comments on the GUI. The general workflow for both tabs is:
</p>
<ul>
  <li>Ensure a writable-to backup directory. The button "Work Dir" will show green,
    if all is in order. Else red. Red means you will not be able to continue until
    a proper backup directory is set up. This script will not create directories on
    its own.</li>
  <li>Load character files. In the case of Horadric Exchange, it is required that
  both characters have progressed far enough to own their own Horadric Cubes.
  The Horazon's Folly tab offers an 'ensure Horadric Cube' function as a short-cut.</li>
  <li>In the case of the Horazon's Folly tab, do whatever edits seem good to you.</li>
  <li>At the bottom of each tab there is one large button. These buttons start out
  disabled, but will activate, once the above conditions are fulfilled.
  <b>The GUI tabs won't do anything definitive to your .d2s files unless the
  large, icon-bearing button at the bottom of the tab is clicked. Only then changes
  will be written to disk.</b></li>
</ul>
<p>
Clicking on such a master button will trigger the associated process. It will do
a backup of any modified <b>.d2s</b> character file, prefixing it with a current
timestamp, suffixing it <b>.backup</b>. It will also do changes to the original
save-game, of course. These are done in-place in your Diablo II Save directory.
</p><p>
Needless to say, that <b>.humanity</b> files, that are created when entering
godmode, need to be sited in the selected backup directory to be found and used.
</p>

<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/horazons_folly.png" alt="The Horazon's Folly tab." class="center_img"><br />
  <figcaption><b>Fig.8</b> - Horazon's Folly, too, uses the backup directory selected
    in the Horadric Exchange tab. However, it acts on only one character file.</figcaption>
</figure>

<h2>Example: Using Horazon's Folly to create the Breath of the Dying Runeword</h2>

<p>
"There is nothing the right potion can't cure."<br />
<i>Lysander</i>
</p>

<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/breath_of_the_dying_ethereal.png" alt="War Pike 'Breath of the Dying'." class="center_img"><br />
  <figcaption><b>Fig.9</b> - Starting out as a regular pike with a weak magical property, Horazon's Workshop turned it into a mighty weapon.</figcaption>
</figure>
<br /><br />

<ul>
<li>Go to Gheed and buy an adequate base item, like a War Axe or a Pike.</li>
<li>Place it into the Horadric Cube.</li>
<li>Save and exit the game, enter Horazon's Folly and open your character file there.</li>
<li>If the base weapon is magical click '<b>dispel magic</b>'.</li>
<li>If the base weapon has items socketed into it, click '<b>empty sockets</b>'.</li>
<li>If the base weapon is of normal quality, click '<b>regrade</b>' twice. Once, if it is exceptional. This will render it elite.</li>
<li>Type 6 into the '<b>set sockets</b>' textbox and click the button.</li>
<li>Seeing that Breath of the Dying has a Zod rune, rendering the item indestructible, click '<b>toggle ethereal</b>' if it isn't ethereal already.</li>
<li>Into the '<b>Runic Cube</b>' textbox enter the required rune names: <b>vex,hel,el,eld,zod,eth</b> and click the button.</li>
<li><b>Commit all these changes by clicking the potion of life</b> at the bottom of the tab.</li>
<li>Reenter the game. In the Horadric Cube, find the 6-socketed ethereal elite weapon, and the necessary runes -- if there is not enough space,
look in stash and backpack. Put the runes into the sockets. Be sure to put them into the right order.</li>
</ul>

<h2>Some Comments on Diablo II save-game Files.</h2>
<p>
This whole project would not exist if it were not for Walter Couto's beautiful
Diablo II save-game file format analysis page:
</p><p>
<a href=https://github.com/WalterCouto/D2CE/blob/main/d2s_File_Format.md>https://github.com/WalterCouto/D2CE/blob/main/d2s_File_Format.md</a>
</p><p>
For the remainder of this text I will silently refer to this source.
Yet, there are a couple of grains of knowledge, that I found on my own, too.
Note however, that, as stated above, all is promised to hold true to v1.10-v1.14d only.
</p>
<h3>Health, Mana, and Stamina Attributes</h3>
<p>
It is true, that these attributes are encoded in 21 bits. However, they are regular in being
encoded forward. Their being hard to decipher stems from the fact, that they encode
a rudimentary floating point schema: The least significant (little endian!) 8 bits
encode "64" for "1/4", "128" for "2/4", and "192" for "3/4"
<i>(i.e., "2<sup>-2</sup>", "2<sup>-1</sup>", and "2<sup>-2</sup>+2<sup>-1</sup>", if you prefer
reading the whole 21 bit number as one large little endian binary float, with a decimal point behind the 8<sup>th</sup> digit)</i>.
The powers that be at Blizzard North, in their infinite wisdom, decided, that balancing of some
characters like the Amazon, or, most notably, the Assassin requires quarter points.
See, e.g., <a href="https://diablo.fandom.com/wiki/Assassin#Attributes">here, at diablo.fandom</a>.
</p><p>
Only the most significant 13 bits encode the actual integer values. I guess, this will probably
set the absolute Maxima of Mana, Life and Stamina to <b>8192.75</b> each.
</p><p>
Here is an example taken using the debugging function <code>--info_stats</code> from
<b>horazons_folly.py</b>.
</p><p>
<i>
Example bit-sequence: ID, Quarters, and proper value (mind little endian!).<br />
Attr-ID: 000100000 (AT_CURRENT_MANA, 8), Storage size: 21, bit range: [188:218]<br />
Val: 00000010 (64 -> 1/4) 0011100000000 (28)<br />
raw: 000100000000000100011100000000
</i>
</p>

<p>
I also cannot confirm that any of the other values are bit-inverted.
</p>
<h3>Attributes and Skills</h3>
<p>
The variable length of the attributes section seems to stem from the fact
that values that are 0 are not listed, but missing. It appears that 0 values
are even illegal.  When I tried to add explicit 0 values this led me into a
corrupt save-game, complaining that the skill section (which is beyond attributes)
were corrupted. Only when I made sure, that 0 values are not present all was well again.
</p><p>
The skills section is far simpler than described. It is prefixed with the code
<b>if</b>. However, after that, there just come 30 byte values describing
the hard-point skill-levels for the individual skills of the character in
question. The order of skills in the skill-trees is over all trees and
horizontally, beginning by the lowest-most tab. Huh?
</p><p>
  <b>Example:</b> Consider the Necromancer. In-game press "T" to open the skills
trees. The lowest tab is "Curses", above is "Poison and Bone", and the top-most
tab is "Summoning". Take these three trees and place them side-by-side:
"Curses" left, "Poison and Bone" in the middle, and on the right "Summoning".
And now read the skills left to right, line by line. First skill is "Amplified
Damage", followed by "Teeth", "Bone Armor", "Skeleton Mastery" and "Raise Skeleton".
Next comes the second row with "Dim Vision", "Weaken", "Poison Dagger", and so on.
The other character classes' skills are organized in the same way.
</p>
<h3>Runeword Magic</h3>
<p>
The extended mods section describes magical and pseudo-magical (like bonuses received for being a superior item) properties.
It is terminated by a sequence '1ff' (or 111111111 in bit-code) and padded with 0s to reach an item length that can be
measured in bytes (i.e., the number of bits is a multipe of 8). If such an item turns into a runeword item, that padding
is dropped and right after the 111111111-terminator a second mod-section is added that will receive its own 111111111 terminator.
In between is the code that describes the magic received by the runeword bonus, which is an addition to the raw power
provided by the socketed runes. The <b>jewelize</b> functions of Horazons Folly may harness that power by turning them into
regular magical enhancement. Thus it becomes possible to, e.g., create a charm from a runeword.
</p>
<h3>Progression. Normal, Nightmare and Hell</h3>
<p>I am not entirely positive on how character progression (i.e. byte 37 of
the .d2s file, still part of the main header) really works. However, it appears that
</p>
<ul>
<li>0 is the starting value</li>
<li>5 is reached upon completion of the normal campaign. This value grants the rank of Slayer/Destroyer and enables nightmare.</li>
<li>10 is reached upon completion of the nightmare campaign. This value grants the rank of Champion/Conqueror and enables hell.</li>
<li>15 is reached upon completion of the hell campaign. This value grants the rank of (M|P)atriarch/Guardian.</li>
</ul>
<h3>Item type codes</h3>
<p>
Each item has a <a href="https://www.gmstemple.com/Diablo2/itemcodes.html">three-letter code</a> defining its elementary nature.
E.g., the unique item of the Horadric Cube is called "box". The runes are, in sequence from 'el' to 'zod', labelled 'r01', .., 'r33'.
These three bytes range from [Bit 76:Bit 100]. This means a bit shift of 4 if you want to read the codes in the original byte format.
</p>

<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/crafted_runes.png" alt="Jah, Ith, Ber, and, for show, a Zod rune." class="center_img"><br />
  <figcaption><b>Fig.10</b> - Jah, Ith, Ber, some gems, a skull, and, for show, a Zod rune. All from Horazon's workshop.</figcaption>
</figure>

<h3>Small Charm Crafting, OSkills, the Enigma of Runeword Magic</h3>
<p>
Concluding this Wiki, let's do some real black magic!
</p><p>
One of the most fascinating properties in the game is the <b>Teleport +1</b> on the Enigma runeword.
It is special, in being not a skill, but a so-called oskill. The fine difference is, that usually
a spell is either restricted to a specific class (<b>Teleport +1 (Sorceress only)</b>), or it resides
on some charged artefact, that needs to be equipped, and repaired after usage.
An oskill is like having actually learned the spell. The character pays not in charges, but in mana!
</p><p>
Let's take the teleport oskill out of the Enigma and put it into a small charm! First, we need access to an Enigma. No problem, if you have read above example on creating a "Breath of the Dying" runeword weapon.
</p>

<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/armor_enigma.png" alt="A Great Hauberk elite armor bearing an Enigma Runeword." class="center_img"><br />
  <figcaption><b>Fig.11</b> - Isn't it a beauty? Let's get to work!</figcaption>
</figure>
<br /><br />
<p>
Ensure the Enigma is within the Horadric Cube, save the game, exit, open Horazon's Folly and there-in load your hero's .d2s file. This will show his entire inventory within the info field. One element is the Enigma. It might look like this:
</p>

<code>
Item 'Great Hauberk' (43 bytes) (elite, armor: True, weapon: False, sockets: 3/3, stack: False, set: False) IB_PLAYER #13 personalization: 'None', index: (1109, 1152)
Max size in inventory: (3, 2), Defense (base): 463, Durability (base): 50/50, Stack: None,
Parent: IP_STORED, Storage: IS_CUBE, (r:0, c:0), Equip: IE_UNSPECIFIED
identified: True, broken: False, socketed: True, newly_found: False, starter_gear: False, compact: False, ethereal: False, personalized: False, runeword: True, 
type code: urs, quality: normal(2), ilevel: 99, is charm: False, Bit length: 344 (43.0 bytes)
No known mods recognized.
  quest_sockets: [108:111], 110
  quality: [150:154], 0100
  custom_graphics: [154:155], 0
  class_specific: [155:156], 0
  quality_attributes: [156:156],
  runeword: [156:172], 1101110000001010
  personalization: [172:172],
  tomes: [172:172],
  realm: [172:173], 0
  defense: [173:184], 10011011100
  durability: [184:201], 01001100010011000
  stack: [201:201],
  set: [201:201],
  sockets: [201:205], 1100
  mods: [205:205],
  mods_runeword: [214:332], 1111100001000000011001101010001110000000011001000001100001100011011000100000111111100010001110110011000000011110000100
Byte code of the Basic Item (no runes!): b"JM\x10\x08\x80\x04e\x00\x00X'7\x072\xe8\x1c~\xd4\xb1\xb0\x03%;22\xe6\xff\x87\x80Yq\x80\t\x86\xb1\x11\xfc\x117\x03\x1e\xf2\x1f"
</code>

<p>
Now you could hit "Forge Charm", drink the potion at the bottom of the screen, reload the game, and find an overpowered small charm, created from the runeword power.
</p>

<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/small_charm_enigma.png" alt="The Enigma Runeword magic on a small charm." class="center_img"><br />
  <figcaption><b>Fig.12</b> - Works as a charm. But can we have individual components?</figcaption>
</figure>
<br /><br />
<p>At the beginning of this text there is a link to the .d2s format page <a href="https://github.com/WalterCouto/D2CE/blob/main/d2s_File_Format.md">D2CE</a>.
Standing on its authors' shoulders enabled this entire Horadric Exchange project. Yet, the text of that format compendium does not include the
specifics of <b>modifications</b>, that may be part of extened objects, granting them magical properties. This text, too, will leave questions open. Still, let's see, what we can learn today.
</p><p>
For understanding modifications, we need to leave the green fields of byte code, and descend into the world of the binary.
</p><p>
The following is in the strict little endian spirit of the whole project. Meaning,
the most insignificant bits come first: A binary of '1011' equals '1+4+8=13', and not '8+2+1=11'.
</p>

<code>
1111100001000000011001101010001110000000011001000001100001100011011000100000111111100010001110110011000000011110000100
</code>

<p>
Above is the entire modification section from the Enigma runeword modifications. But how to read it?
First off, there is no such thing as a header to it. It is a plain list of the subsequent properties,
that will not be necessarily displayed in the same order, when you view the item in the game.
Also, the individual items are not of uniform length. The common factor is, that they all start with a 9 bit id. That id defines what comes after as parameters. Here are the specifics:
</p>
<ul>
<li>111110000 10000000110: "Defense Bonus 759". After the 9-bit id, like in the regular defense section, we see 11 bits of plain defense value, with an offset of 10. So, the value we are looking for, is 759+10=769.</li>
<li>011010100 0111000: "14 Life/Kill". The 14 in encoded plainly, in 7 bit.</li>
<li>000001100 1000001: "45% Faster Run/Walk". 7 bit, too. The payload value is 65.</li>
<li>100001100 011011000 100000: "Teleport +1". The coveted oskill property. The id is general for 'oskill'. The 9+6 parameter is made from the skill ID "54" for teleport, and the skill level, which here is plain 1<sup>1</sup>.</li>
<li>111111100 010: "+2 to all Skills". A memorable ID, followed by 3 bits for the parameter.</li>
<li>001110110 011000: "+64 Strength", based on character level (which is 86)<sup>2</sup>.</li>
<li>000011110 000100: "+86 Magic Find", based on character level (which is 86)<sup>2</sup>.</li>
</ul>
<p>
1): A large list of such IDs may be found here: <a href="https://github.com/WalterCouto/D2CE/blob/main/source/res/TXT/global/excel/skills.txt">https://github.com/WalterCouto/D2CE/blob/main/source/res/TXT/global/excel/skills.txt</a>.
</p><p>
2): This is another floating point value, representing the factor to be multiplied onto the character level.
The point comes behind the 3rd of the 6 numbers. The value is still little endian binary.
Thus, we have the digits for <i>2<sup>-3</sup>2<sup>-2</sup>2<sup>-1</sup>2<sup>0</sup>2<sup>1</sup>2<sup>2</sup></i>.
In these examples <i>000100</i> equals <i>2<sup>0</sup>=1</i>, leading to a Magic Find value of 1*86=86 for a level 86 character.
Likewise, <i>011000</i> equals <i>2<sup>-2</sup>+2<sup>-1</sup>==3/4</i>, leading to a strength bonus of (3/4)*86=64 for a level 86
character. It seems, that the decimals of the precise 64.5 result are truncated.
</p><p>
These are leads to dissecting any modification section. Afterwards you will have to translate the section back into appropriately
shifted byte code and insert it into, e.g., a small charm. If python is an option for you, consider a function like that
(it is not part of Horazon's Folly, which is about ease of use, which is not, what we get, when modifying individual bits. Fun as that may be:
</p>

<code>
def bin2bts(bin, pfname="/home/your_awesome_username/enigma.cube"):
    """Will insert the given binary string (little endian) into a template for a small charm.
    Then it will pad the result, convert it into a proper bytes string and write it to disk.
    :param bin: Little endian style string holding the entire modification section to be put
      into a small charm.
    :param pfname: Path and file name to the .cube file that will be created. It will hold
      a complete small charm that can be loaded into a Horadric Cube, using Horazon's Folly.
    :returns: The bytes string that is also written into new file pfname."""
    bin = '01010010101100100000100000000000000000010000000010100110000000000000000000011100011010110110100011000000010000000110011000001011101100001010110110001100101100000000000000000000000000' + bin + '111111111'
    while len(bin) % 8 != 0:
        bin = bin + '0'
    n = len(bin)//8
    val = int(bin[::-1],2)
    bts = val.to_bytes(n,'little')
    with open(pfname, 'wb') as OUT:
        OUT.write(bts)
    return bts
</code>

<p>Using above function will result in this byte code, when creating an oskill "Teleport +5"
on a small charm:</p>
<code>
b'JM\x10\x00\x80\x00e\x00\x008\xd6\x16\x03\x02f\xd0\r\xb51\r\x00\x00@\x18\x1b\xc5\x7f'
</code>
<p>
Experiment! Modify bit by bit. The worst that can happen, is that the game won't start due to corrupt inventory data.
You can even replace the corrupt item with your next attempt, using Horazon's Folly.
For what it is worth, <a href="https://github.com/kochsoft/diablo2/blob/main/doc/general_science/mods.tsv">this file</a>
already includes a couple of bit sequences that seem valid.
</p>

<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/small_charm_teleport_5.png" alt="Oskill Teleport +5 on a small charm." class="center_img"><br />
  <figcaption><b>Fig.13</b> - Neatly tucked away into the backpack, this will allow anyone to fly. Provided level 24 has been reached and there is a minimum of mana.</figcaption>
</figure>

<h3>Putting an Army onto a Small Charm.</h3>
<p>
Consider the Paladin. A lonely hero, although he is such a nice, social person! He should have
an army to care for as no one does like he does.
</p><p>
Let's design a small charm for that! It should have some useful oskills. An oskill has the shape: <b>100001100[9 bit skill id][6 bit level]</b>. Our charm could have:
</p>

<ul>
<li>101001000 001010 (37): Warmth +20</li>
<li>011011000 101000 (54): Teleport +5</li>
<li>101000100 001010 (69): Skeleton Mastery +20</li>
<li>111100100 001010 (79): Golem Mastery +20</li>
<li>011000100 010100 (70): Raise Skeleton +10</li>
<li>000010100 010100 (80): Raise Skeletal Mage +10</li>
<li>111110100 101000 (96): Revive: +5</li>
<li>110100100 010100 (75): Clay Golem +10</li>
<li>000001000 010100 (32): Valkyrie +10</li>
</ul>

<p>
Putting it all together, each with the prefix, 100001100, leads to:
</p>

<code>
binary =  '100001100101001000001010100001100011011000101000100001100101000100001010100001100111100100001010100001100011000100010100100001100000010100010100100001100111110100101000100001100110100100010100100001100000001000010100'

bin2bts(binary, 'small_charm_summoners_delight.cube')

b'JM\x10\x00\x80\x00e\x00\x008\xd6\x16\x03\x02f\xd0\r\xb51\r\x00\x00@\x98\x12T\x18\x1bE\x98"T\x98\'T\x18#J\x18(J\x98/E\x98%J\x18\x10\xca\x7f'
</code>
<p>
As a gimmick, these examples may also be created from the Horazon's Folly "Runes to Cube"
function. Try the codes 'tel', 'sdt', 'bod', or 'inf'.
</p>
<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/small_charm_summoners_delight.png" alt="Oskill Necromancer Army and Lady on a small charm." class="center_img"><br />
  <figcaption><b>Fig.14</b> - Pocket Army.</figcaption>
</figure>
<br /><br />
<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/paladin_army.png" alt="The dreaded Halloween Party Paladin." class="center_img"><br />
  <figcaption><b>Fig.15</b> - The dreaded Halloween Party Paladin.</figcaption>
</figure>
<br /><br />
<p>As a final example, consider the runeword 'Infinity' on a jewel. One modification seemed necessary: On a jewel, using charged
skills does not work. Hence, an autocast probability upon being hit is being used for the Cyclone Armor.</p>
<figure>
  <img src="https://github.com/kochsoft/diablo2/blob/main/wiki/infinity_stone.png" alt="Infinity Stone." class="center_img"><br />
  <figcaption><b>Fig.16</b> - There is an Infinity Stone in Sanctuary.</figcaption>
</figure>
